<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="lang">

<head>
  <title data-vue-tag="true">Async Is Best Sync - Robert Corponoi</title><meta data-vue-tag="true" charset="utf-8"><meta data-vue-tag="true" name="generator" content="Gridsome v0.5.8"><meta data-vue-tag="true" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="true" data-key="description" name="description" content="My Blog"><meta data-vue-tag="true" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="true" name="description" content="I&#x27;ve learned that there are two kinds of people in this world, people that love async and people that don&#x27;t understand async enough to realize they love it."><link data-vue-tag="true" rel="icon" type="image/png" sizes="16x7" href="/assets/static/favicon.ce0531f.bd9c2d4.png"><link data-vue-tag="true" rel="icon" type="image/png" sizes="32x13" href="/assets/static/favicon.ac8d93a.bd9c2d4.png"><link data-vue-tag="true" rel="icon" type="image/png" sizes="96x38" href="/assets/static/favicon.b9532cc.bd9c2d4.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="76x30" href="/assets/static/favicon.f22e9f3.bd9c2d4.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="152x60" href="/assets/static/favicon.62d22cb.bd9c2d4.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="120x48" href="/assets/static/favicon.1539b60.bd9c2d4.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="167x66" href="/assets/static/favicon.dc0cdc5.bd9c2d4.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="180x71" href="/assets/static/favicon.7b22250.bd9c2d4.png"><noscript data-vue-tag="true" ><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/0.styles.b790beff.css" as="style"><link rel="preload" href="/assets/js/app.7ffbed1a.js" as="script"><link rel="preload" href="/assets/js/component--post.f1fec353.js" as="script"><link rel="prefetch" href="/assets/js/component--404.976cca3c.js"><link rel="prefetch" href="/assets/js/component--category.4534527e.js"><link rel="prefetch" href="/assets/js/component--contact.e9fb7bf4.js"><link rel="prefetch" href="/assets/js/component--home.037c2ea9.js"><link rel="prefetch" href="/assets/js/component--tag.66079b6b.js"><link rel="prefetch" href="/assets/js/page-query.09592927.js"><link rel="stylesheet" href="/assets/css/0.styles.b790beff.css">
</head>

<body data-vue-tag="">
  <script>
    // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
    (function () {
      window.__onThemeChange = function () { };
      function setTheme(newTheme) {
        window.__theme = newTheme;
        preferredTheme = newTheme;
        document.body.setAttribute('data-theme', newTheme);
        window.__onThemeChange(newTheme);
      }

      var preferredTheme;
      try {
        preferredTheme = localStorage.getItem('theme');
      } catch (err) { }

      window.__setPreferredTheme = function (newTheme) {
        setTheme(newTheme);
        try {
          localStorage.setItem('theme', newTheme);
        } catch (err) { }
      }

      var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
      darkQuery.addListener(function (e) {
        window.__setPreferredTheme(e.matches ? 'dark' : 'light')
      });

      setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
    })();
  </script>

  <div id="app" data-server-rendered="true"><nav class="navbar"><div class="container"><a href="/" class="navbar__logo">RC</a><span id="navbar-toggle" class="navbar__toggle"><div id="nav-icon" class="nav-icon"><div></div></div></span><ul id="navbar-main" class="navbar__main hide"><li><a href="/category/tutorials" class="navbar__links">Tutorials</a></li><li><a href="/category/professional" class="navbar__links">Professional</a></li><li><a href="/category/personal" class="navbar__links">Personal</a></li><li><a href="/category/nmotw" class="navbar__links">NMOTW</a></li><li><a href="/contact" class="navbar__links">Let's Work Together</a></li></ul></div></nav><div class="header"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div><main class="main"><div class="post container"><div class="post__header"><h1 class="post__title">Async Is Best Sync</h1><div class="post-meta post__meta">
  Committed 25. June 2019.
  <strong>6 min parse.</strong></div><img alt="Cover image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 860 644' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-7'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-7)' width='860' height='644' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAwAEADASIAAhEBAxEB/8QAGgABAAMBAQEAAAAAAAAAAAAABQIDBAEGB//EACwQAAICAQQBBAEEAgMBAAAAAAECAwQRAAUSITETIkFRYQYUIyQVMjNSkfD/xAAZAQADAQEBAAAAAAAAAAAAAAABAwQAAgX/xAAsEQABAgMFBgcBAAAAAAAAAAABAhEAAzESIUFRYQRxkaHB8BMUgbHR4fEi/9oADAMBAAIRAxEAPwD4YNuvfqB2k2utL/ACV9EFgDn3M874/wDvGkhtMk0clRGieD0Dh4uVxoWB9qF/aiksBkA/OjWWO7HC1%2b4FqxPhYmYzu/qEMQqRgKvZyewcn50xuN6CalLTia087RoWF6wV5SfiCLrGAB7s47OstLgEYQZCwlQCyxOeGrDKDZILcslarTzemZOJiLmwyMDjtVwoH5PXnOmau2y%2bvRffRRqSWFYpLbl9UumD/rBDk4wMd4GSPvWipVkp7ZOksy1q1gGSQ3J1owmMgBP4k/kZiADjsEYx96vRLK7LDW2fc1ah6v7WaeGOKjXfiM4M8mJCQWXIIwez851rRUaxmCEmylzneSeJ%2bII3Sl6qw2DC8teMOsa2Y0pkOrYYKF95C5z2Rkg6ha2azDVqXtn/AHVaRCZJLUkP7WFSA3uWRvczY76GfdqypDAk8bQ35bT4aOYbZEwbkpyv9iU4K5HkfHwdS/UTQ2hFLSgE9tnJ5Oz3p2yoJLOfZ1n4HWfoA6JE25KKZt%2bQoTETFOWtAUJDDU4DfBE0MEm4f8psWFEVhp9uPNuWcNmSTHeQDkDGSfrUtyr0EyZrMELh%2baqsrXZ%2byfacARDySRrDDYlFqGzKkNkTxCPlOfVEXvK5KrgLg56P3qW8pudfb7P75I0WWXiYnCq5dOjhF9yjA7JxnSpiXILk95CKpcoJe0Rndf0flDi2JYfQi3CtNFTsqgirt/Si9pIZuK5Z1ABPeM4%2bTjVznfo6EtrY0SrtjwP60lFBUiIDnKpLIecgK4JI77x8aC2%2bpvcl2W3tFSyj8VQyAc%2bHIYGZW6%2b/n4/GkjTSfd19MvO1aAssKf2wsy4CgkngoLAswBwo%2bW8awYMFKD6dco6YJVaDdN2PONeybPs920BZ3ia7uL85TFtdfmzqAxOZ5iAG6%2bj%2bMk60ULFS/Tr0P09%2bn4obVmwsJsI7XbEkmCVIZmEcbEr2MDIX5Gu24Y6sU12eltUu5WsSqp3IXGlVjyPGGLCDo593t6AAGdduWa%2b5vLQ/yciwLXDbbbt4oQ1xzMcxMMSsWYkYwTkgnOpvNAEFAxr38g3FoM9ZnJMtRccqNSnd8ZZ60T2aa3bEUsk65jS0xssoHZBhh6T8Ie/Ot94vTrU13OO3E1qRhEb7CGHHFiGFaMFiGIx7uux14xq3KS1RomOhJapQzy%2blG9Oou305F5AuGkP8rZGAPkZGfrRG7X6IilryVYIkryoTLtkbSGQ%2b1kZ7Uhy2S3XgDv4610qbtG0qeg73H3iVGyS9mS4DA0fG/DDhHd2nqQR1kdbaARErBTrLt8CFgRksxZ3xjJJ7GD40NDYFdlaOys08r8GlpwAM3yAZpABk/YGevzqG5zxw2CkyU4PSaQSIHNuVJAx5dZ4jJ%2bfHZI86r3Att0MovVVks%2bkGjF2bmRyHLKxp7c4%2b/vTk7KAi5Zf079t8JmTJniWSGGcX1dvewrT7nvlWnBc/sgmR5ZDkdH0Iuge/nHWnbe5RGKaGzPYlrzyqwa7IalcFRkkV4znyeix7%2bs683VgaWAQJL7gkb4iRK0Z8huTnDHHt7HnvUYGsSbiae0pHIJZEj5QpzBZvAaRz/wCk%2bMfjQVJDOVF8qffP0ilM2bOmAEBs3H17E6x6unJuO607g2eCGrtwZFsJVjjoV0UjK85ZDybxno4PnREwXaLdlYrUEDTQ8T%2bwh/cksrdH1pCMc8kll%2bh1rJZpS0YIIrW40muwvyjWKY25VK4AT/oB4%2bSBg6lvDKm4GLdCzy%2bI5tyk/wBBxyB6UZIxnwcnyNdJQgiwwA3fpgp2ewfE/qYz0LNrgLt3GL4r7TlGgSUSJIYSsoe7KPbyUqRhBkgjA%2bjnVUu4PYrTtuDwyB1eAf5GwGKyIB0I0HRw3RP1gHrGktzu1odqeNm3hrPpqZPVK0a0TnixwmDJIOzjx0R1orNtqx/ZcljEMcTvDV9KIRvgjnI4yAcMeWPOfvVBJKXbpwidEqUJtyiwoLyQcyW1%2bBBWaaGNZ0nnQhc8yIEz%2bFHZ68ePOmLlSzfjaFKyV6qzFgYoPQgKgYzzf3YXz8nB8axjZq8FiNIN1gfci%2bYkpKZSjKQQxkbAx0cYOfnU7O6zRT2P6otzK5ZHvk2ZYsHscekHxnrSSqPQUi04QSrUk8qAcI//2Q==' /%3e%3c/svg%3e" width="860" data-src="/assets/static/async-is-best-sync.07cc2b7.827d625.jpg" data-srcset="/assets/static/async-is-best-sync.a67b0b2.827d625.jpg 480w, /assets/static/async-is-best-sync.07cc2b7.827d625.jpg 860w" data-sizes="(max-width: 860px) 100vw, 860px" class="post__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/async-is-best-sync.07cc2b7.827d625.jpg" class="post__image g-image g-image--loaded" width="860" alt="Cover image"></noscript></div><div class="post__content"><h2 id="dont-fear-async-is-here"><a href="#dont-fear-async-is-here" aria-hidden="true"><span class="icon icon-link"></span></a>Don't Fear, Async Is Here!</h2>
<p>I've learned that there are two kinds of people in this world, people that love async and people that don't understand async enough to realize they love it. Asynchronous JavaScript lets you avoid callback hell and it can increase code readability drastically, that is unless you have a very wide monitor and prefer things being indented 200 times. If you don't know what callback hell is, there is a great <a href="http://callbackhell.com/" target="_blank" rel="nofollow noopener noreferrer">website dedicated to it here</a>.</p>
<h2 id="what-exactly-are-promises-and-async-functions"><a href="#what-exactly-are-promises-and-async-functions" aria-hidden="true"><span class="icon icon-link"></span></a>What exactly are Promises and Async Functions?</h2>
<p>So to understand why promises are needed we need to understand why callback are needed. While computers are incredibly fast these days and some things may seem instant, they are not. Thing like loading files and making http requests can take time and we don't want to try to work with data that may or may not exist yet. So in this essence, a callback lets you define a function to run once the operation has completed which ensures that your function will run. An example of this that we'll use is a typical request to read a file in Node.</p>
<pre class="language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'/path/to/file.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

  <span class="token comment">// Now we can work with the file data.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>You'll see that you have to use the contents of the data variable inside of the callback to ensure that it is available. If you did something like this to try to access the data outside of the function, it will be undefined.</p>
<pre class="language-js"><span class="token keyword">let</span> fileData<span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'/path/to/file.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

  fileData <span class="token operator">=</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will be undefined because it probably hasn't happened yet.</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>As you can see above, it won't work because the console.log statement will be called before readFile can finish. If you do an asynchronous action like this in the browser it can be misleading because you'll see the data but it won't actually be there. What you're seeing is a reference to the data and so it eventually gets populated before you see it but you can't actually work with it programmatically outside of the asynchronous operation.</p>
<p>Promises essentially do the same things as callbacks but they enable you to chain the results of callbacks so that you don't end up with crazy indentations and async makes Promises even more pretty by flattening even more.</p>
<h2 id="that-doesnt-look-so-bad-why-bother-with-promises"><a href="#that-doesnt-look-so-bad-why-bother-with-promises" aria-hidden="true"><span class="icon icon-link"></span></a>That Doesn't Look So Bad, Why Bother With Promises?</h2>
<p>You're right, in that simple case above it's not terrible, just one indent after all. How about when you have many?</p>
<pre class="language-js"><span class="token function">asyncFunction1</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">asyncFunction2</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">moreData</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">asyncFunction3</span><span class="token punctuation">(</span>moreData<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">dataOverload</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Finally done!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>In this example you can clearly see how it can get out on control. If you're thinking this won't happen to you because this is not a real example then just think of making XHR requests and creating images in the browser. You can end up with callback chains very quickly and it only makes it harder to refactor the longer you wait. Now promises work by 'resolving' the data retrieved from the callback so it can be used in a flatter sense. To see how this works, we'll take the previous example with <code class="language-text">fs.readFile</code> and make it return a Promise.</p>
<pre class="language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">promisfyReadFile</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">promisfyReadFile</span><span class="token punctuation">(</span><span class="token string">'/path/to/file.txt'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// We can use data here.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// If there was an error.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>Now let's break this down, at first from looking at it you probably realize that it is lengthier than the original. While that is true, you only have to write <code class="language-text">promiseReadFile</code> once and then you can use it as a promise forever. With the callback method, you would have to create and use that callback every single time which is a huge inconvenience. To make the <code class="language-text">fs.readFile</code> method into a Promise, we have to wrap it in a call that would return the result of the Promise. The call is always the same, you're going to have <code class="language-text">resolve</code> to return the data that you want to work with and <code class="language-text">reject</code> which is used to catch errors.</p>
<p>Now when we use the Promise, we'll always have a <code class="language-text">then</code> which has the data from the promise <code class="language-text">resolve</code> and then the <code class="language-text">catch</code> which contains the <code class="language-text">reject</code> error if there was one. This setup is pretty similar across all Promises and you can use it as a template for building your own.</p>
<p>Back to our fake chained callback, let's see how it would look as Promises so you can see how chained Promises work.</p>
<pre class="language-js"><span class="token function">asyncFunction1</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">asyncFunction2</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">moreData</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">asyncFunction3</span><span class="token punctuation">(</span>moreData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataOverload</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Finally done!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>Well now, isn't that much better looking! It's all very flat, just one level of identation and it's super easy to read. Each <code class="language-text">then</code> will contain the result of calling the previous function and if you compare this example with the callback one you should be able to follow it fairly easily.</p>
<h2 id="ok-you-convinced-me-to-use-promises-now-what-about-async"><a href="#ok-you-convinced-me-to-use-promises-now-what-about-async" aria-hidden="true"><span class="icon icon-link"></span></a>Ok You Convinced Me To Use Promises, Now What About Async?</h2>
<p>If you understand how Promises work, then you're already 90% of the way there because async is really just syntatic sugar for promises. To demonstrate lets take our promise from above:</p>
<pre class="language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">promisfyReadFile</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">promisfyReadFile</span><span class="token punctuation">(</span><span class="token string">'/path/to/file.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre>
<p>The first thing I'm sure you'll notice is that <code class="language-text">promisfyReadFile</code> did not change one bit. This is because, like I said before, async is really just a prettier way to consume a Promise. What you have to do differently with async is wrap it in a function that signifies that it is using async/await and then wrap the function call in a <code class="language-text">try/catch</code> block so that you can catch errors. The other keyword here besides async is await which just means it waits for <code class="language-text">promisfyReadFile</code> function to return its value before proceeding.</p>
<p>To end this article, lets show that Promise chain as using async/await:</p>
<pre class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncFunction1</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> moreData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncFunction2</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> dataOverload <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncFunction3</span><span class="token punctuation">(</span>moreData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre>
<p>Look at how clean that is, everything is on the same indent and super easy to read.</p>
<h2 id="conclusion"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>I have no doubt you probably still have questions at this point but don't worry, it's not the easiest concept because there is a lot to it and you can get overloaded with information about it. What I recommend you do is find a function in any code that you've written (preferably one that's tested so you can make sure the functionality is still the same) and change it to use a Promise. Then after ensuring that it still works as expected, try to spice it up and make it use async/await and test again. I'm always a firm believer that practice makes perfect so just keep at it until it clicks and makes sense and it becomes second nature for you.</p>
</div><div class="post__footer"><div class="post-tags"><a href="/tag/async" class="post-tags__link">async</a><a href="/tag/promises" class="post-tags__link">promises</a><a href="/tag/callbacks" class="post-tags__link">callbacks</a><a href="/tag/javascript" class="post-tags__link">javascript</a><a href="/tag/es6" class="post-tags__link">es6</a><a href="/tag/esm" class="post-tags__link">esm</a></div></div><div class="author post__author"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 328 328' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-32'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-32)' width='328' height='328' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAGwAAAwADAQEAAAAAAAAAAAAABQYHAwQIAgH/xAAzEAACAQMDAQUGBgIDAAAAAAABAgMEBREAEiEGBxMxQVEiMmFxgaEUFSRCkbEWF1Jy0f/EABoBAAIDAQEAAAAAAAAAAAAAAAMFAQIEBgD/xAAjEQACAQUAAQQDAAAAAAAAAAABAgADBBESITEFIkFRMmFx/9oADAMBAAIRAxEAPwA9cIAwPGkLqy4wWOneokY7z7KRr4s3lqkVmApLHAAySfIahN6qpes%2bpJoYsiipmCRJ5nnBPzP9aXW9Mu36mhjiA67rO8zNuScQIPAIcZ%2bemHpbq%2btqahY5XeoIGe728sPnonRdlhkG%2bsnjiQ%2bCp7TaYKXpOisqI1NE25f3n3mPx0wqUBryQjHPYWslTBdDLHEWSeE4kiYjcujUdrJ8zpY63qloLnZurLbFtq639BXQpwjSqAVfHhkrx9M6odslFVRQTlAhkQMVznaSPDOsTe2XIggWfIzgn66%2b/k4/4N99TvtJ6sq7J1PW08QWSAKhy7SewSPABWA%2bOkqp60rZYnkUR4Xg4aUf2%2bpFJmGRIyo4TL5dwWoqhVbYTG2G9OPHUH7LKpafqqoQ4aGYNyT4YOc6vFzy9NMqDLFCACcZONR609IzWW6w1k7hpEqoldR7ojc4LfycfXRbAjYgylT7lETqBJJAtJRPON20SMwRP5Pj8hohf5Vp7GZ49kcznbge0E9Do7VdK22odKqopBM6Y7pS3Ef/AFHloddKFmJpFh3gKGZR5D0z8tOGQBeQaZY9kshsV0vUdXDEa4yzAsnfSAIxXlSFxx8PMaovZkaxelojcEZJjI5w3z5%2b%2bdeaKj7iXEcxPdngZ5A8s%2bh0fpNkMAWMYUkt9SST9zpTeAcI%2bYdeDEjHaDVU3%2bb3iOaquMbxkSNHSsANoRcHnz50p1kVJWIqw1dwnxLt2zcgEcnPPpon2gSP/sLqRkJw0XdHHkCE51p9Po0aTtK6lu9iYKPINlSdeRQqbSrElsS91UmAdJd8v9NbL7RiaLv8KWli2g95EeCpz6n%2btNNZIApycD11z/1Tfqi5XiWo2LGvMUPHOzdwT8dZLVHd9k%2bJZio/KdQ9A9TUd7twMZIaMlCjkFlHln6Y51iu0tZLVyzQRmGFSRvbgEaivYhRXK49UyRvLURU5gbMyN7j/tOPPJBH86rs0vUtCssFVQyVOw47yFS6sP7Guip76jbzMpYA88QAtL%2bGnasErGLJbhs7vXR%2bjlP4aPd4lQT9dA6ikrrjUhpaeSlpoxl93sk/ADStYr/eLVevynqfawbmKryArA%2b6c8DHl8Dpbf0mbGIZGBgnqCwS3bqW/VERQFqsR5J5wEXI%2bXhpPq6Wqs9z7tvGRlRiQTuUEeH8afhfaCmvd4inq4o5Gq2cBmxkbV5z4aEdUV9BXT0MUNRFLL36g7GyQDpalWopII5DMAY09QdU0EcM0MDtNKyMgKDgEgjOTqW9ygKDaGZRjJ50VenwSx5J15WAA5xjnOuys/TKdoCF7n7iSrdmp5lI7DrlR0N0mo6oiMzsGSQ%2bo8vvroOWJChYcEj3h56473tBKslOdrgg8HH1HodPll7VrxQUqU8%2bJ1TgF%2bDola3bbZZFOsCMGV%2b5W8AMijCP5nUI7WJ4vzGno4WDPAmXIPgSeB9tGr72t3a50ppqeCGDjHeDlv8AzU3qQ1RI8tQ5aRiSSTkk6qlsSdmGJdq4AwDNaUQA/qIllBHssfeH11kpKSmlnikgYq0bh9pPjjWvOAxIGePDOsSIy8gkHOdAufTUrA/B%2b4Wjdmn/ACf/2Q==' /%3e%3c/svg%3e" width="328" data-src="/assets/static/author.de4034a.47c56ff.jpg" data-srcset="/assets/static/author.de4034a.47c56ff.jpg 328w" data-sizes="(max-width: 328px) 100vw, 328px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/author.de4034a.47c56ff.jpg" class="author__image g-image g-image--loaded" width="328" alt="Author image"></noscript><div class="author__bio"><p class="author__name">Robert Corponoi</p><p class="author__intro">Self proclaimed JavaScript ninja.</p></div><a href="https://twitter.com/robertcorponoi" target="_blank" class="btn btn--secondary">Follow</a></div></div></main><footer class="footer"><div class="container"><ul class="soc"><li><a href="https://twitter.com/robertcorponoi" target="_blank" title="Twitter" class="soc__icon soc__icon--twitter"><div class="soc__ir"><svg viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"></path></svg></div></a></li><li><a href="https://github.com/robertcorponoi" target="_blank" title="GitHub" class="soc__icon soc__icon--github"><div class="soc__ir"><svg viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"></path></svg></div></a></li><li><a href="https://www.linkedin.com/in/robert-corponoi-1353a1112/" target="_blank" title="LinkedIn" class="soc__icon soc__icon--linkedin"><div class="soc__ir"><svg viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"></path></svg></div></a></li></ul><span class="footer__copyright">Copyright © 2019 Robert Corponoi</span><a href="https://opensource.org/licenses/MIT" target="_blank" class="footer__license">All Code MIT Licensed</a></div></footer></div>
  <script src="/assets/js/app.7ffbed1a.js" defer></script><script src="/assets/js/component--post.f1fec353.js" defer></script>
</body>

</html>